<!DOCTYPE html>
<!-- Generated by Cython 0.28.3 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: orthtree.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.3</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="orthtree/orthtree.c">orthtree.c</a></p>
<div class="cython"><pre class="cython line score-0">&#xA0;<span class="">001</span>: # cython: language_level=3, cdivision=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: import cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: from cpython.mem cimport PyMem_Malloc, PyMem_Free</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: from cpython.ref cimport PyObject, Py_XINCREF, Py_XDECREF</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: # This is the struct in which the objects get stored</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">008</span>: cdef struct container:</pre>
<pre class='cython code score-0 '>struct __pyx_t_8orthtree_container {
  PyObject *item;
  double *pos;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">009</span>:     PyObject* item</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>:     double *pos</pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: # This the the struct representing an individual tree.</pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: # The subtree pointer gets initialized to none until a tree needs to split.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: cdef struct tree:</pre>
<pre class='cython code score-0 '>struct __pyx_t_8orthtree_tree {
  struct __pyx_t_8orthtree_tree *subtree;
  struct __pyx_t_8orthtree_container *bucket;
  double *pos1;
  double *pos2;
  int number_of_elements;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">015</span>:     tree *subtree</pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>:     container *bucket</pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>:     double *pos1</pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>:     double *pos2</pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>:     int number_of_elements</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: # This function is a fast method to compute if a given point is within a bounding rectangular</pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: # hypervolume given by two other points.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>: cdef bint is_within(int num_dims, double* position_1, double* position_2, double* position):</pre>
<pre class='cython code score-0 '>static int __pyx_f_8orthtree_is_within(int __pyx_v_num_dims, double *__pyx_v_position_1, double *__pyx_v_position_2, double *__pyx_v_position) {
  int __pyx_v_i;
  double __pyx_v_a;
  double __pyx_v_b;
  double __pyx_v_p;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_within", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">024</span>:     cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:     cdef double a, b, p</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>:     for i in range(num_dims):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_num_dims;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">028</span>:         a = position_1[i]</pre>
<pre class='cython code score-0 '>    __pyx_v_a = (__pyx_v_position_1[__pyx_v_i]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>:         b = position_2[i]</pre>
<pre class='cython code score-0 '>    __pyx_v_b = (__pyx_v_position_2[__pyx_v_i]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>:         p = position[i]</pre>
<pre class='cython code score-0 '>    __pyx_v_p = (__pyx_v_position[__pyx_v_i]);
</pre><pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>:         if a &gt;= p &gt;= b:</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (__pyx_v_a &gt;= __pyx_v_p);
    if (__pyx_t_4) {
      __pyx_t_4 = (__pyx_v_p &gt;= __pyx_v_b);
    }
    __pyx_t_5 = (__pyx_t_4 != 0);
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>:             continue</pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>:         elif b &gt;= p &gt;= a:</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = (__pyx_v_b &gt;= __pyx_v_p);
    if (__pyx_t_5) {
      __pyx_t_5 = (__pyx_v_p &gt;= __pyx_v_a);
    }
    __pyx_t_4 = (__pyx_t_5 != 0);
    if (__pyx_t_4) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>:             continue</pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">036</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:             return False</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_r = 0;
      goto __pyx_L0;
    }
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>:     return True</pre>
<pre class='cython code score-0 '>  __pyx_r = 1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">039</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: # Function which recursively frees up the memory used by a tree.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>: cdef void clean_up(tree* parent_ptr, int children):</pre>
<pre class='cython code score-0 '>static void __pyx_f_8orthtree_clean_up(struct __pyx_t_8orthtree_tree *__pyx_v_parent_ptr, int __pyx_v_children) {
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clean_up", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">042</span>:     cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:     # First we free up pos2, our parent caller cleans pos1.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:     PyMem_Free(parent_ptr[0].pos2)</pre>
<pre class='cython code score-5 '>  <span class='py_c_api'>PyMem_Free</span>((__pyx_v_parent_ptr[0]).pos2);
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>:     # Then we free any elements which may be in the tree's bucket.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:     for i in range(parent_ptr[0].number_of_elements):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_parent_ptr[0]).number_of_elements;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:         Py_XDECREF(parent_ptr[0].bucket[i].item)</pre>
<pre class='cython code score-0 '>    Py_XDECREF(((__pyx_v_parent_ptr[0]).bucket[__pyx_v_i]).item);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:         PyMem_Free(parent_ptr[0].bucket[i].pos)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(((__pyx_v_parent_ptr[0]).bucket[__pyx_v_i]).pos);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:     # Free up the bucket itself!</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>:     PyMem_Free(parent_ptr[0].bucket)</pre>
<pre class='cython code score-5 '>  <span class='py_c_api'>PyMem_Free</span>((__pyx_v_parent_ptr[0]).bucket);
</pre><pre class="cython line score-0">&#xA0;<span class="">054</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>:     # Recursively cleanup any children!</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:     if parent_ptr[0].subtree:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_parent_ptr[0]).subtree != 0);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:         for i in range(children):</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_children;
    __pyx_t_2 = __pyx_t_1;
    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:             clean_up(&amp;(parent_ptr[0].subtree[i]), children)</pre>
<pre class='cython code score-0 '>      __pyx_f_8orthtree_clean_up((&amp;((__pyx_v_parent_ptr[0]).subtree[__pyx_v_i])), __pyx_v_children);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">059</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>:         # Then clean up the children themselves and the pos1 which they all share.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:         PyMem_Free(parent_ptr[0].subtree[0].pos1)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(((__pyx_v_parent_ptr[0]).subtree[0]).pos1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:         PyMem_Free(parent_ptr[0].subtree)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>((__pyx_v_parent_ptr[0]).subtree);
</pre><pre class="cython line score-0">&#xA0;<span class="">063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: # Subdivision function</pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>: # May raise memory errors, but it will prevent leaks by clever handling.</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">066</span>: cdef bint subdivide(int num_dims, int bucket_size, tree* parent_ptr):</pre>
<pre class='cython code score-3 '>static int __pyx_f_8orthtree_subdivide(int __pyx_v_num_dims, int __pyx_v_bucket_size, struct __pyx_t_8orthtree_tree *__pyx_v_parent_ptr) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_number_of_children;
  struct __pyx_t_8orthtree_container *__pyx_v_bucket;
  double *__pyx_v_pos1;
  double *__pyx_v_pos2;
  struct __pyx_t_8orthtree_tree *__pyx_v_subtree;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("subdivide", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("orthtree.subdivide", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">067</span>:     cdef int i, j</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:     cdef int number_of_children = 1 &lt;&lt; num_dims</pre>
<pre class='cython code score-0 '>  __pyx_v_number_of_children = (1 &lt;&lt; __pyx_v_num_dims);
</pre><pre class="cython line score-0">&#xA0;<span class="">069</span>:     cdef container *bucket</pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>:     cdef double *pos1</pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>:     cdef double *pos2</pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:     cdef tree* subtree</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:     # Do not re-subdivide trees, the demons will come out!</pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>:     # This should never actually evaluate to true, any modern CPU will simply branch predict over it, so its entirely</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>:     # free.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:     if parent_ptr[0].subtree:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_parent_ptr[0]).subtree != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:         return False</pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>:     # Allocating the array of tree structs, setting is done later in case we memory error.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:     subtree = &lt;tree*&gt;PyMem_Malloc(sizeof(tree) * number_of_children)</pre>
<pre class='cython code score-5 '>  __pyx_v_subtree = ((struct __pyx_t_8orthtree_tree *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(struct __pyx_t_8orthtree_tree)) * __pyx_v_number_of_children)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:     if not subtree:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_v_subtree != 0)) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:         raise MemoryError('could not allocate memory for subtrees')</pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 83, __pyx_L1_error)</span>
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_su);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-0">&#xA0;<span class="">084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>:     # All subtrees share a single pos1, parent trees are responsible for cleaning it.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:     pos1 = &lt;double*&gt;PyMem_Malloc(sizeof(double) * num_dims)</pre>
<pre class='cython code score-5 '>  __pyx_v_pos1 = ((double *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(double)) * __pyx_v_num_dims)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:     if not pos1:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_v_pos1 != 0)) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:         PyMem_Free(subtree)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(__pyx_v_subtree);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:         raise MemoryError('could not allocate memory for midpoint')</pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 89, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_mi);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-0">&#xA0;<span class="">090</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:     # pos1 is actually just the average of the two points of the tree</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>:     for i in range(num_dims):</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_num_dims;
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>:         pos1[i] = (parent_ptr[0].pos1[i] + parent_ptr[0].pos2[i]) / 2</pre>
<pre class='cython code score-0 '>    (__pyx_v_pos1[__pyx_v_i]) = ((((__pyx_v_parent_ptr[0]).pos1[__pyx_v_i]) + ((__pyx_v_parent_ptr[0]).pos2[__pyx_v_i])) / 2.0);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">094</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>:     # This is the loop in which each of the children are initialized, 5 things need to be done!</pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:     # If this memory errors it does some very clever handling to free up the mess it has made.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>:     for i in range(number_of_children):</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_number_of_children;
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">098</span>:         # First we set the sub subtrees to point to NULL.</pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>:         # And they also initially contain nothing.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:         subtree[i].subtree = NULL</pre>
<pre class='cython code score-0 '>    (__pyx_v_subtree[__pyx_v_i]).subtree = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:         subtree[i].number_of_elements = 0</pre>
<pre class='cython code score-0 '>    (__pyx_v_subtree[__pyx_v_i]).number_of_elements = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>:         # Allocate the struct of containers: the bucket.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:         bucket = &lt;container*&gt;PyMem_Malloc(sizeof(container) * bucket_size)</pre>
<pre class='cython code score-5 '>    __pyx_v_bucket = ((struct __pyx_t_8orthtree_container *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(struct __pyx_t_8orthtree_container)) * __pyx_v_bucket_size)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">105</span>:         if not bucket:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((!(__pyx_v_bucket != 0)) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">106</span>:             # Clean up memory then raise an exception</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:             PyMem_Free(pos1)</pre>
<pre class='cython code score-5 '>      <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>:             for j in range(i):</pre>
<pre class='cython code score-0 '>      __pyx_t_6 = __pyx_v_i;
      __pyx_t_7 = __pyx_t_6;
      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_j = __pyx_t_8;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:                 PyMem_Free(subtree[j].bucket)</pre>
<pre class='cython code score-5 '>        <span class='py_c_api'>PyMem_Free</span>((__pyx_v_subtree[__pyx_v_j]).bucket);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:                 PyMem_Free(subtree[j].pos2)</pre>
<pre class='cython code score-5 '>        <span class='py_c_api'>PyMem_Free</span>((__pyx_v_subtree[__pyx_v_j]).pos2);
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:             PyMem_Free(subtree)</pre>
<pre class='cython code score-5 '>      <span class='py_c_api'>PyMem_Free</span>(__pyx_v_subtree);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:             raise MemoryError('could not allocate memory for subtree')</pre>
<pre class='cython code score-10 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 112, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_su_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">113</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>:         # Allocate an array for pos2</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:         pos2 = &lt;double*&gt;PyMem_Malloc(sizeof(double) * num_dims)</pre>
<pre class='cython code score-5 '>    __pyx_v_pos2 = ((double *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(double)) * __pyx_v_num_dims)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:         if not pos2:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((!(__pyx_v_pos2 != 0)) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">117</span>:             # Clean up memory then raise an exception, including bucket.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:             PyMem_Free(bucket)</pre>
<pre class='cython code score-5 '>      <span class='py_c_api'>PyMem_Free</span>(__pyx_v_bucket);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:             PyMem_Free(pos1)</pre>
<pre class='cython code score-5 '>      <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:             for j in range(i):</pre>
<pre class='cython code score-0 '>      __pyx_t_6 = __pyx_v_i;
      __pyx_t_7 = __pyx_t_6;
      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_j = __pyx_t_8;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:                 PyMem_Free(subtree[j].bucket)</pre>
<pre class='cython code score-5 '>        <span class='py_c_api'>PyMem_Free</span>((__pyx_v_subtree[__pyx_v_j]).bucket);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:                 PyMem_Free(subtree[j].pos2)</pre>
<pre class='cython code score-5 '>        <span class='py_c_api'>PyMem_Free</span>((__pyx_v_subtree[__pyx_v_j]).pos2);
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:             PyMem_Free(subtree)</pre>
<pre class='cython code score-5 '>      <span class='py_c_api'>PyMem_Free</span>(__pyx_v_subtree);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:             raise MemoryError('could not allocate memory for subtree')</pre>
<pre class='cython code score-10 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 124, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_su_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-0">&#xA0;<span class="">125</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:         subtree[i].bucket = bucket</pre>
<pre class='cython code score-0 '>    (__pyx_v_subtree[__pyx_v_i]).bucket = __pyx_v_bucket;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:         subtree[i].pos1 = pos1</pre>
<pre class='cython code score-0 '>    (__pyx_v_subtree[__pyx_v_i]).pos1 = __pyx_v_pos1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:         subtree[i].pos2 = pos2</pre>
<pre class='cython code score-0 '>    (__pyx_v_subtree[__pyx_v_i]).pos2 = __pyx_v_pos2;
</pre><pre class="cython line score-0">&#xA0;<span class="">129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>:         # Computing the position of each child!</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:         for j in range(num_dims):</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_num_dims;
    __pyx_t_7 = __pyx_t_6;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_j = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">132</span>:             # The second point on the child trees is actually every combination you can make choosing coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>:             # From pos1 or pos2 of the parent.</pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>:             # Because its a binary choice we use a binary counter for this.</pre>
<pre class="cython line score-0">&#xA0;<span class="">135</span>:             # The i'th child's pos2's j'th bit is equal to the j'th bit of the parent's pos 1 or pos2 depending on if</pre>
<pre class="cython line score-0">&#xA0;<span class="">136</span>:             # the j'th bit of i in binary is a 0 or a 1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>:             # Word explanation but it makes sense as an example.</pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>:             #</pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>:             # Consider the 5th child of a octree (3D), i = 5 -&gt; 101</pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>:             # Its pos2 would then be (parent_pos2[0], parent_pos1[1], parent_pos2[2])</pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>:             # Because the 0th bit of 5 is 1, 1st is 0 and 2nd is 1. ( Read right-to-left)</pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:             if i &amp; (1 &lt;&lt; j):</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_i &amp; (1 &lt;&lt; __pyx_v_j)) != 0);
      if (__pyx_t_1) {
/* … */
        goto __pyx_L18;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:                 pos2[j] = parent_ptr[0].pos1[j]</pre>
<pre class='cython code score-0 '>        (__pyx_v_pos2[__pyx_v_j]) = ((__pyx_v_parent_ptr[0]).pos1[__pyx_v_j]);
</pre><pre class="cython line score-0">&#xA0;<span class="">145</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:                 pos2[j] = parent_ptr[0].pos2[j]</pre>
<pre class='cython code score-0 '>      /*else*/ {
        (__pyx_v_pos2[__pyx_v_j]) = ((__pyx_v_parent_ptr[0]).pos2[__pyx_v_j]);
      }
      __pyx_L18:;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:     # Now that the subtree has been completely created we may actually set it.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:     parent_ptr[0].subtree = subtree</pre>
<pre class='cython code score-0 '>  (__pyx_v_parent_ptr[0]).subtree = __pyx_v_subtree;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:     return True</pre>
<pre class='cython code score-0 '>  __pyx_r = 1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">151</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>: # Insert into Tree function</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>: cdef bint insert_object(tree* parent_ptr, int bucket_size, int num_dims, double* pos, PyObject* item):</pre>
<pre class='cython code score-3 '>static int __pyx_f_8orthtree_insert_object(struct __pyx_t_8orthtree_tree *__pyx_v_parent_ptr, int __pyx_v_bucket_size, int __pyx_v_num_dims, double *__pyx_v_pos, PyObject *__pyx_v_item) {
  int __pyx_v_i;
  int __pyx_v_number_of_children;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert_object", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("orthtree.insert_object", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">154</span>:     cdef int i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:     cdef int number_of_children = 1 &lt;&lt; num_dims</pre>
<pre class='cython code score-0 '>  __pyx_v_number_of_children = (1 &lt;&lt; __pyx_v_num_dims);
</pre><pre class="cython line score-0">&#xA0;<span class="">156</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>:     # First we check if it is within this tree!</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:     if not is_within(num_dims, parent_ptr[0].pos1, parent_ptr[0].pos2, pos):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((!(__pyx_f_8orthtree_is_within(__pyx_v_num_dims, (__pyx_v_parent_ptr[0]).pos1, (__pyx_v_parent_ptr[0]).pos2, __pyx_v_pos) != 0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:         return False</pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">160</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>:     # If the parent has space add it and return</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:     if parent_ptr[0].number_of_elements &lt; bucket_size:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_parent_ptr[0]).number_of_elements &lt; __pyx_v_bucket_size) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:         parent_ptr[0].bucket[parent_ptr[0].number_of_elements].item = item</pre>
<pre class='cython code score-0 '>    ((__pyx_v_parent_ptr[0]).bucket[(__pyx_v_parent_ptr[0]).number_of_elements]).item = __pyx_v_item;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:         parent_ptr[0].bucket[parent_ptr[0].number_of_elements].pos = pos</pre>
<pre class='cython code score-0 '>    ((__pyx_v_parent_ptr[0]).bucket[(__pyx_v_parent_ptr[0]).number_of_elements]).pos = __pyx_v_pos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:         parent_ptr[0].number_of_elements += 1</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = 0;
    (__pyx_v_parent_ptr[__pyx_t_2]).number_of_elements = ((__pyx_v_parent_ptr[__pyx_t_2]).number_of_elements + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:         return True</pre>
<pre class='cython code score-0 '>    __pyx_r = 1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:     # No space, need to subdivide</pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>:     # If subdivide fails the python method will handle freeing pos.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:     subdivide(num_dims, bucket_size, parent_ptr)</pre>
<pre class='cython code score-0 '>  (void)(__pyx_f_8orthtree_subdivide(__pyx_v_num_dims, __pyx_v_bucket_size, __pyx_v_parent_ptr));
</pre><pre class="cython line score-0">&#xA0;<span class="">171</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:     for i in range(number_of_children):</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_number_of_children;
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:         if insert_object(&amp;(parent_ptr[0].subtree[i]), bucket_size, num_dims, pos, item):</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_f_8orthtree_insert_object((&amp;((__pyx_v_parent_ptr[0]).subtree[__pyx_v_i])), __pyx_v_bucket_size, __pyx_v_num_dims, __pyx_v_pos, __pyx_v_item) != 0);
    if (__pyx_t_1) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:             return True</pre>
<pre class='cython code score-0 '>      __pyx_r = 1;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">175</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:     # We shouldn't ever arrive here, the point must be inside one of the children.</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:     raise AttributeError('could not insert item into tree')</pre>
<pre class='cython code score-10 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_AttributeError, __pyx_tuple__5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_insert_item_into_tree);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class="cython line score-0">&#xA0;<span class="">178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>: # Complete acceptance function, skips all of the faff, this is the secret sauce to the speed.</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>: cdef void complete_grab(list query_results, tree* parent_ptr, int number_of_children):</pre>
<pre class='cython code score-3 '>static void __pyx_f_8orthtree_complete_grab(PyObject *__pyx_v_query_results, struct __pyx_t_8orthtree_tree *__pyx_v_parent_ptr, int __pyx_v_number_of_children) {
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complete_grab", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("orthtree.complete_grab", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">181</span>:     cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>:     # Grab every item in tree</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:     for i in range(parent_ptr[0].number_of_elements):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_parent_ptr[0]).number_of_elements;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:         query_results.append(&lt;object&gt;parent_ptr[0].bucket[i].item)</pre>
<pre class='cython code score-9 '>    if (unlikely(__pyx_v_query_results == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
      <span class='error_goto'>__PYX_ERR(0, 185, __pyx_L1_error)</span>
    }
    __pyx_t_4 = ((PyObject *)((__pyx_v_parent_ptr[0]).bucket[__pyx_v_i]).item);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_query_results, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>:     # complete_grab every child of tree</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:     if parent_ptr.subtree:</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (__pyx_v_parent_ptr-&gt;subtree != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:         for i in range(number_of_children):</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_number_of_children;
    __pyx_t_2 = __pyx_t_1;
    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:             complete_grab(query_results, &amp;(parent_ptr[0].subtree[i]), number_of_children)</pre>
<pre class='cython code score-0 '>      __pyx_f_8orthtree_complete_grab(__pyx_v_query_results, (&amp;((__pyx_v_parent_ptr[0]).subtree[__pyx_v_i])), __pyx_v_number_of_children);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: # Query Function, finds all points inside bounding box, number of children needs to be passed to avoid</pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>: # Recomputing it each time, probably a premature optimization but whatever.</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">194</span>: cdef void query(list query_results, int num_dims, int number_of_children, tree* parent_ptr, double* pos1, double* pos2):</pre>
<pre class='cython code score-3 '>static void __pyx_f_8orthtree_query(PyObject *__pyx_v_query_results, int __pyx_v_num_dims, int __pyx_v_number_of_children, struct __pyx_t_8orthtree_tree *__pyx_v_parent_ptr, double *__pyx_v_pos1, double *__pyx_v_pos2) {
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("query", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("orthtree.query", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">195</span>:     cdef bint a, b</pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>:     cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>:     # First we check if both corners of the tree are within q, if this is true we can do a complete grab</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:     a = is_within(num_dims, pos1, pos2, parent_ptr[0].pos1)</pre>
<pre class='cython code score-0 '>  __pyx_v_a = __pyx_f_8orthtree_is_within(__pyx_v_num_dims, __pyx_v_pos1, __pyx_v_pos2, (__pyx_v_parent_ptr[0]).pos1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:     b = is_within(num_dims, pos1, pos2, parent_ptr[0].pos2)</pre>
<pre class='cython code score-0 '>  __pyx_v_b = __pyx_f_8orthtree_is_within(__pyx_v_num_dims, __pyx_v_pos1, __pyx_v_pos2, (__pyx_v_parent_ptr[0]).pos2);
</pre><pre class="cython line score-0">&#xA0;<span class="">201</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:     if a or b:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_a != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (__pyx_v_b != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:         if a &amp; b:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_a &amp; __pyx_v_b) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>:             # Completely withing the bounding box</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:             complete_grab(query_results, parent_ptr, number_of_children)</pre>
<pre class='cython code score-0 '>      __pyx_f_8orthtree_complete_grab(__pyx_v_query_results, __pyx_v_parent_ptr, __pyx_v_number_of_children);
</pre><pre class="cython line score-0">&#xA0;<span class="">206</span>:         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">207</span>:             # Partial overlap with bounding box, check more slowly and verify for each object.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:             for i in range(parent_ptr[0].number_of_elements):</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_3 = (__pyx_v_parent_ptr[0]).number_of_elements;
      __pyx_t_4 = __pyx_t_3;
      for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
        __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:                 if is_within(num_dims, pos1, pos2, parent_ptr[0].bucket[i].pos):</pre>
<pre class='cython code score-0 '>        __pyx_t_1 = (__pyx_f_8orthtree_is_within(__pyx_v_num_dims, __pyx_v_pos1, __pyx_v_pos2, ((__pyx_v_parent_ptr[0]).bucket[__pyx_v_i]).pos) != 0);
        if (__pyx_t_1) {
/* … */
        }
      }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:                     query_results.append(&lt;object&gt;parent_ptr[0].bucket[i].item)</pre>
<pre class='cython code score-9 '>          if (unlikely(__pyx_v_query_results == Py_None)) {
            <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
            <span class='error_goto'>__PYX_ERR(0, 210, __pyx_L1_error)</span>
          }
          __pyx_t_6 = ((PyObject *)((__pyx_v_parent_ptr[0]).bucket[__pyx_v_i]).item);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_query_results, __pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 210, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>:             # Recursively do the same for each child</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:             if parent_ptr[0].subtree:</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_parent_ptr[0]).subtree != 0);
      if (__pyx_t_1) {
/* … */
      }
    }
    __pyx_L6:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:                 for i in range(number_of_children):</pre>
<pre class='cython code score-0 '>        __pyx_t_3 = __pyx_v_number_of_children;
        __pyx_t_4 = __pyx_t_3;
        for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
          __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:                     query(query_results, num_dims, number_of_children, &amp;(parent_ptr[0].subtree[i]), pos1, pos2)</pre>
<pre class='cython code score-0 '>          __pyx_f_8orthtree_query(__pyx_v_query_results, __pyx_v_num_dims, __pyx_v_number_of_children, (&amp;((__pyx_v_parent_ptr[0]).subtree[__pyx_v_i])), __pyx_v_pos1, __pyx_v_pos2);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:     # Neither points of the tree are within the query box, but the query box may still intersect the tree still.</pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>:     # An example of this is the query box being entirely within the tree.</pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>:     # This is the exact same check as the one for if one of the tree points is within the query box.</pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:         a = is_within(num_dims, parent_ptr[0].pos1, parent_ptr[0].pos2, pos1)</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_a = __pyx_f_8orthtree_is_within(__pyx_v_num_dims, (__pyx_v_parent_ptr[0]).pos1, (__pyx_v_parent_ptr[0]).pos2, __pyx_v_pos1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:         b = is_within(num_dims, parent_ptr[0].pos1, parent_ptr[0].pos2, pos2)</pre>
<pre class='cython code score-0 '>    __pyx_v_b = __pyx_f_8orthtree_is_within(__pyx_v_num_dims, (__pyx_v_parent_ptr[0]).pos1, (__pyx_v_parent_ptr[0]).pos2, __pyx_v_pos2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:         if a or b:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_v_a != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_2 = (__pyx_v_b != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:             for i in range(parent_ptr[0].number_of_elements):</pre>
<pre class='cython code score-0 '>      __pyx_t_3 = (__pyx_v_parent_ptr[0]).number_of_elements;
      __pyx_t_4 = __pyx_t_3;
      for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
        __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:                 if is_within(num_dims, pos1, pos2, parent_ptr[0].bucket[i].pos):</pre>
<pre class='cython code score-0 '>        __pyx_t_1 = (__pyx_f_8orthtree_is_within(__pyx_v_num_dims, __pyx_v_pos1, __pyx_v_pos2, ((__pyx_v_parent_ptr[0]).bucket[__pyx_v_i]).pos) != 0);
        if (__pyx_t_1) {
/* … */
        }
      }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:                     query_results.append(&lt;object&gt;parent_ptr[0].bucket[i].item)</pre>
<pre class='cython code score-9 '>          if (unlikely(__pyx_v_query_results == Py_None)) {
            <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
            <span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span>
          }
          __pyx_t_6 = ((PyObject *)((__pyx_v_parent_ptr[0]).bucket[__pyx_v_i]).item);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_query_results, __pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 226, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">227</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:             if parent_ptr[0].subtree:</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_parent_ptr[0]).subtree != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:                 for i in range(number_of_children):</pre>
<pre class='cython code score-0 '>        __pyx_t_3 = __pyx_v_number_of_children;
        __pyx_t_4 = __pyx_t_3;
        for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
          __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:                     query(query_results, num_dims, number_of_children, &amp;(parent_ptr[0].subtree[i]), pos1, pos2)</pre>
<pre class='cython code score-0 '>          __pyx_f_8orthtree_query(__pyx_v_query_results, __pyx_v_num_dims, __pyx_v_number_of_children, (&amp;((__pyx_v_parent_ptr[0]).subtree[__pyx_v_i])), __pyx_v_pos1, __pyx_v_pos2);
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:     return</pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">234</span>: # This class is just a holder which makes __iter__ work.</pre>
<pre class="cython line score-0">&#xA0;<span class="">235</span>: @cython.internal</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>: cdef class TreePointer:</pre>
<pre class='cython code score-0 '>struct __pyx_obj_8orthtree_TreePointer {
  PyObject_HEAD
  struct __pyx_t_8orthtree_tree *ptr;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">237</span>:     cdef tree* ptr</pre>
<pre class="cython line score-0">&#xA0;<span class="">238</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">240</span>: # This is the main class.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>: cdef class Orthtree:</pre>
<pre class='cython code score-0 '>struct __pyx_obj_8orthtree_Orthtree {
  PyObject_HEAD
  struct __pyx_t_8orthtree_tree root;
  int number_of_objects;
  int number_of_dims;
  int bucket_size;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">242</span>:     cdef tree root</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:     cdef readonly int number_of_objects, number_of_dims, bucket_size</pre>
<pre class='cython code score-18 '>/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_17number_of_objects_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8orthtree_8Orthtree_17number_of_objects_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_17number_of_objects___get__(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_17number_of_objects___get__(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;number_of_objects);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.number_of_objects.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_14number_of_dims_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8orthtree_8Orthtree_14number_of_dims_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_14number_of_dims___get__(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_14number_of_dims___get__(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;number_of_dims);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.number_of_dims.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_11bucket_size_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8orthtree_8Orthtree_11bucket_size_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_11bucket_size___get__(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_11bucket_size___get__(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;bucket_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.bucket_size.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">244</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:     def __init__(self, position_1, position_2, bucket_size = 8):</pre>
<pre class='cython code score-33 '>/* Python wrapper */
static int __pyx_pw_8orthtree_8Orthtree_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_8orthtree_8Orthtree_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_position_1 = 0;
  PyObject *__pyx_v_position_2 = 0;
  PyObject *__pyx_v_bucket_size = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_position_1,&amp;__pyx_n_s_position_2,&amp;__pyx_n_s_bucket_size,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)__pyx_int_8);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_position_1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_position_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bucket_size);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_position_1 = values[0];
    __pyx_v_position_2 = values[1];
    __pyx_v_bucket_size = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8orthtree_8Orthtree___init__(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self), __pyx_v_position_1, __pyx_v_position_2, __pyx_v_bucket_size);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_8orthtree_8Orthtree___init__(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self, PyObject *__pyx_v_position_1, PyObject *__pyx_v_position_2, PyObject *__pyx_v_bucket_size) {
  PyObject *__pyx_v_list_position_1 = 0;
  PyObject *__pyx_v_list_position_2 = 0;
  int __pyx_v_i;
  double *__pyx_v_pos1;
  double *__pyx_v_pos2;
  struct __pyx_t_8orthtree_container *__pyx_v_bucket;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_list_position_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_list_position_2);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:         cdef tuple list_position_1 = tuple(position_1)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_position_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_list_position_1 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:         cdef tuple list_position_2 = tuple(position_2)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_position_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_list_position_2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">248</span>:         cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>:         cdef double* pos1</pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>:         cdef double* pos2</pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>:         cdef container* bucket</pre>
<pre class="cython line score-0">&#xA0;<span class="">252</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:         self.number_of_dims = len(list_position_1)</pre>
<pre class='cython code score-1 '>  __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_list_position_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  __pyx_v_self-&gt;number_of_dims = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:         self.number_of_objects = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;number_of_objects = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">255</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:         if len(list_position_1) != len(list_position_2):</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_list_position_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_list_position_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  __pyx_t_4 = ((__pyx_t_2 != __pyx_t_3) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:             raise SyntaxError('dimensions of arguments are mismatched!')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_SyntaxError, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 257, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_dimensions_of_arguments_are_mism);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 257, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-0">&#xA0;<span class="">258</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:         self.bucket_size = int(bucket_size)</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_bucket_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_self-&gt;bucket_size = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:         if self.bucket_size &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_self-&gt;bucket_size &lt; 1) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:             raise IndexError('bucket size must be greater than 0')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_IndexError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 261, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_bucket_size_must_be_greater_than);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class="cython line score-0">&#xA0;<span class="">262</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">263</span>:         # Beyond here we are actually creating the root tree struct!</pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>:         # Note that the subtrees array isn't allocated until needed!</pre>
<pre class="cython line score-0">&#xA0;<span class="">265</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:         pos1 = &lt;double*&gt;PyMem_Malloc(sizeof(double) * self.number_of_dims)</pre>
<pre class='cython code score-5 '>  __pyx_v_pos1 = ((double *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(double)) * __pyx_v_self-&gt;number_of_dims)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:         if not pos1:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((!(__pyx_v_pos1 != 0)) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:             raise MemoryError('could not allocate memory for tree')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 268, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_tr);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class="cython line score-0">&#xA0;<span class="">269</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:         pos2 = &lt;double*&gt;PyMem_Malloc(sizeof(double) * self.number_of_dims)</pre>
<pre class='cython code score-5 '>  __pyx_v_pos2 = ((double *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(double)) * __pyx_v_self-&gt;number_of_dims)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:         if not pos2:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((!(__pyx_v_pos2 != 0)) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:             PyMem_Free(pos1)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:             raise MemoryError('could not allocate memory for tree')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 273, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_tr);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 273, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-0">&#xA0;<span class="">274</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:         bucket = &lt;container*&gt;PyMem_Malloc(sizeof(container) * self.bucket_size)</pre>
<pre class='cython code score-5 '>  __pyx_v_bucket = ((struct __pyx_t_8orthtree_container *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(struct __pyx_t_8orthtree_container)) * __pyx_v_self-&gt;bucket_size)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:         if not bucket:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((!(__pyx_v_bucket != 0)) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:             PyMem_Free(pos1)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:             PyMem_Free(pos2)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos2);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:             raise MemoryError('could not allocate memory for tree')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_tr);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-0">&#xA0;<span class="">280</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">281</span>:         # 5 Things need to be set whenever a subtree is created.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:         self.root.subtree = NULL</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;root.subtree = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:         self.root.bucket = bucket</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;root.bucket = __pyx_v_bucket;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:         self.root.pos1 = pos1</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;root.pos1 = __pyx_v_pos1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:         self.root.pos2 = pos2</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;root.pos2 = __pyx_v_pos2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:         self.root.number_of_elements = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;root.number_of_elements = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">287</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:         for i in range(self.number_of_dims):</pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;number_of_dims;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:             self.root.pos1[i] = float(list_position_1[i])</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_list_position_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_t_1); if (unlikely(__pyx_t_8 == ((double)((double)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    (__pyx_v_self-&gt;root.pos1[__pyx_v_i]) = __pyx_t_8;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:             self.root.pos2[i] = float(list_position_2[i])</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_list_position_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_t_1); if (unlikely(__pyx_t_8 == ((double)((double)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    (__pyx_v_self-&gt;root.pos2[__pyx_v_i]) = __pyx_t_8;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">291</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:     def __dealloc__(self):</pre>
<pre class='cython code score-0 '>/* Python wrapper */
static void __pyx_pw_8orthtree_8Orthtree_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_8orthtree_8Orthtree_3__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_8orthtree_8Orthtree_2__dealloc__(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_8orthtree_8Orthtree_2__dealloc__(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self) {
  int __pyx_v_number_of_children;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:         cdef int number_of_children = 1 &lt;&lt; self.number_of_dims</pre>
<pre class='cython code score-0 '>  __pyx_v_number_of_children = (1 &lt;&lt; __pyx_v_self-&gt;number_of_dims);
</pre><pre class="cython line score-0">&#xA0;<span class="">294</span>:         # Clean up the entire hierarchy, all except root's pos1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:         clean_up(&amp;(self.root), number_of_children)</pre>
<pre class='cython code score-0 '>  __pyx_f_8orthtree_clean_up((&amp;__pyx_v_self-&gt;root), __pyx_v_number_of_children);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:         PyMem_Free(self.root.pos1)</pre>
<pre class='cython code score-5 '>  <span class='py_c_api'>PyMem_Free</span>(__pyx_v_self-&gt;root.pos1);
</pre><pre class="cython line score-0">&#xA0;<span class="">297</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:     def insert(self, item, position):</pre>
<pre class='cython code score-28 '>/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_5insert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_8orthtree_8Orthtree_5insert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_item = 0;
  PyObject *__pyx_v_position = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_item,&amp;__pyx_n_s_position,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_item)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_position)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "insert") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_item = values[0];
    __pyx_v_position = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_4insert(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self), __pyx_v_item, __pyx_v_position);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_4insert(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self, PyObject *__pyx_v_item, PyObject *__pyx_v_position) {
  PyObject *__pyx_v_item_ptr;
  PyObject *__pyx_v_position_list = 0;
  double *__pyx_v_pos;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_position_list);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:         cdef PyObject* item_ptr = &lt;PyObject*&gt;item</pre>
<pre class='cython code score-0 '>  __pyx_v_item_ptr = ((PyObject *)__pyx_v_item);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:         cdef tuple position_list = tuple(position)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_position);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_position_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">301</span>:         cdef double* pos</pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>:         cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>:         if len(position_list) != self.number_of_dims:</pre>
<pre class='cython code score-1 '>  __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_position_list);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 304, __pyx_L1_error)</span>
  __pyx_t_3 = ((__pyx_t_2 != __pyx_v_self-&gt;number_of_dims) != 0);
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>:             raise IndexError('invalid position')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_IndexError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_invalid_position);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-0">&#xA0;<span class="">306</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:         pos = &lt;double*&gt;PyMem_Malloc(sizeof(double) * self.number_of_dims)</pre>
<pre class='cython code score-5 '>  __pyx_v_pos = ((double *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(double)) * __pyx_v_self-&gt;number_of_dims)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:         if not pos:</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((!(__pyx_v_pos != 0)) != 0);
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:             raise MemoryError('could not allocate space for position')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_space_for_pos);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 309, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
</pre><pre class="cython line score-0">&#xA0;<span class="">310</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:         for i in range(self.number_of_dims):</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;number_of_dims;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:             pos[i] = float(position[i])</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_position, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_t_1); if (unlikely(__pyx_t_7 == ((double)((double)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    (__pyx_v_pos[__pyx_v_i]) = __pyx_t_7;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">314</span>:         # Calling our handy dandy C function to inset it into the tree!</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:         try:</pre>
<pre class='cython code score-0 '>  {
    /*try:*/ {
/* … */
    }
    __pyx_L11_try_return:;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:             if insert_object(&amp;(self.root), self.bucket_size, self.number_of_dims, pos, item_ptr):</pre>
<pre class='cython code score-0 '>      __pyx_t_3 = (__pyx_f_8orthtree_insert_object((&amp;__pyx_v_self-&gt;root), __pyx_v_self-&gt;bucket_size, __pyx_v_self-&gt;number_of_dims, __pyx_v_pos, __pyx_v_item_ptr) != 0);
      if (__pyx_t_3) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:                 self.number_of_objects += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_self-&gt;number_of_objects = (__pyx_v_self-&gt;number_of_objects + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:                 Py_XINCREF(item_ptr)</pre>
<pre class='cython code score-0 '>        Py_XINCREF(__pyx_v_item_ptr);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:                 return True</pre>
<pre class='cython code score-2 '>        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
        __pyx_r = Py_True;
        goto __pyx_L11_try_return;
</pre><pre class="cython line score-0">&#xA0;<span class="">320</span>:             else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:                 return False</pre>
<pre class='cython code score-2 '>      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
        __pyx_r = Py_False;
        goto __pyx_L11_try_return;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">322</span>:         except(MemoryError, AttributeError):</pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>:             # In this case pos has not been stored, so it needs to be cleaned!</pre>
<pre class="cython line score-0">&#xA0;<span class="">324</span>:             PyMem_Free(pos)</pre>
<pre class="cython line score-0">&#xA0;<span class="">325</span>:             raise Exception</pre>
<pre class="cython line score-0">&#xA0;<span class="">326</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:     def to_list(self):</pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_7to_list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_8orthtree_8Orthtree_7to_list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_list (wrapper)", 0);
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_6to_list(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_6to_list(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self) {
  PyObject *__pyx_v_query_results = 0;
  int __pyx_v_number_of_children;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_list", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.to_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_query_results);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_8orthtree_8Orthtree_10generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
</pre><pre class="cython line score-0">&#xA0;<span class="">328</span>:         # Very simple method, just complete_grabs the root tree.</pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>:         # much faster than calling list() with the tree as an object.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>:         cdef list query_results = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_query_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:         cdef int number_of_children = 1 &lt;&lt; self.number_of_dims</pre>
<pre class='cython code score-0 '>  __pyx_v_number_of_children = (1 &lt;&lt; __pyx_v_self-&gt;number_of_dims);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:         complete_grab(query_results, &amp;self.root, number_of_children)</pre>
<pre class='cython code score-0 '>  __pyx_f_8orthtree_complete_grab(__pyx_v_query_results, (&amp;__pyx_v_self-&gt;root), __pyx_v_number_of_children);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>:         return query_results</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_query_results);
  __pyx_r = __pyx_v_query_results;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">334</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>:     def __iter__(self):</pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_9__iter__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_8orthtree_8Orthtree_9__iter__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__ (wrapper)", 0);
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_8__iter__(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_8__iter__(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self) {
  struct __pyx_obj_8orthtree___pyx_scope_struct____iter__ *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__", 0);
  __pyx_cur_scope = (struct __pyx_obj_8orthtree___pyx_scope_struct____iter__ *)__pyx_tp_new_8orthtree___pyx_scope_struct____iter__(__pyx_ptype_8orthtree___pyx_scope_struct____iter__, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_8orthtree___pyx_scope_struct____iter__ *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  {
    __pyx_CoroutineObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_coroutine_body_t) __pyx_gb_8orthtree_8Orthtree_10generator, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_Orthtree___iter, __pyx_n_s_orthtree);<span class='error_goto'> if (unlikely(!gen)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_8orthtree_8Orthtree_8__iter___2generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
/* … */
static PyObject *__pyx_gb_8orthtree_8Orthtree_10generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__", 0);
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>
/* … */
  /* function exit code */
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r); __pyx_r = 0;
  <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Coroutine_clear</span>((PyObject*)__pyx_generator);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_obj_8orthtree___pyx_scope_struct____iter__ {
  PyObject_HEAD
  int __pyx_v_number_of_children;
  PyObject *__pyx_v_recursive_yielding_generator;
  struct __pyx_obj_8orthtree_TreePointer *__pyx_v_root;
  struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">336</span>:         # Fancy generator of sorts.</pre>
<pre class="cython line score-0">&#xA0;<span class="">337</span>:         # Testing cpdefs</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:         cdef int number_of_children = 1 &lt;&lt; self.number_of_dims</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_number_of_children = (1 &lt;&lt; __pyx_cur_scope-&gt;__pyx_v_self-&gt;number_of_dims);
</pre><pre class="cython line score-0">&#xA0;<span class="">339</span>: </pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>:         def recursive_yielding_generator(TreePointer pointer):</pre>
<pre class='cython code score-35 '>/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_8__iter___1recursive_yielding_generator(PyObject *__pyx_self, PyObject *__pyx_v_pointer); /*proto*/
static PyMethodDef __pyx_mdef_8orthtree_8Orthtree_8__iter___1recursive_yielding_generator = {"recursive_yielding_generator", (PyCFunction)__pyx_pw_8orthtree_8Orthtree_8__iter___1recursive_yielding_generator, METH_O, 0};
static PyObject *__pyx_pw_8orthtree_8Orthtree_8__iter___1recursive_yielding_generator(PyObject *__pyx_self, PyObject *__pyx_v_pointer) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("recursive_yielding_generator (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_pointer), __pyx_ptype_8orthtree_TreePointer, 1, "pointer", 0))) <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_8__iter___recursive_yielding_generator(__pyx_self, ((struct __pyx_obj_8orthtree_TreePointer *)__pyx_v_pointer));

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_8__iter___recursive_yielding_generator(PyObject *__pyx_self, struct __pyx_obj_8orthtree_TreePointer *__pyx_v_pointer) {
  struct __pyx_obj_8orthtree___pyx_scope_struct_1_recursive_yielding_generator *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("recursive_yielding_generator", 0);
  __pyx_cur_scope = (struct __pyx_obj_8orthtree___pyx_scope_struct_1_recursive_yielding_generator *)__pyx_tp_new_8orthtree___pyx_scope_struct_1_recursive_yielding_generator(__pyx_ptype_8orthtree___pyx_scope_struct_1_recursive_yielding_generator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_8orthtree___pyx_scope_struct_1_recursive_yielding_generator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_8orthtree___pyx_scope_struct____iter__ *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope);
  __pyx_cur_scope-&gt;__pyx_v_pointer = __pyx_v_pointer;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_pointer);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_pointer);
  {
    __pyx_CoroutineObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_coroutine_body_t) __pyx_gb_8orthtree_8Orthtree_8__iter___2generator1, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_recursive_yielding_generator, __pyx_n_s_iter___locals_recursive_yieldi, __pyx_n_s_orthtree);<span class='error_goto'> if (unlikely(!gen)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.__iter__.recursive_yielding_generator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_gb_8orthtree_8Orthtree_8__iter___2generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("recursive_yielding_generator", 0);
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>
/* … */
  /* function exit code */
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("recursive_yielding_generator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r); __pyx_r = 0;
  <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Coroutine_clear</span>((PyObject*)__pyx_generator);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_pointer, __pyx_n_s_i, __pyx_n_s_child_pointer);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_8orthtree_8Orthtree_8__iter___1recursive_yielding_generator, 0, __pyx_n_s_iter___locals_recursive_yieldi, ((PyObject*)__pyx_cur_scope), __pyx_n_s_orthtree, __pyx_d, ((PyObject *)__pyx_codeobj__16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_recursive_yielding_generator = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__16 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__15, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_orthtree_pyx, __pyx_n_s_recursive_yielding_generator, 340, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">341</span>:             cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>:             cdef TreePointer child_pointer</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>:             for i in range(pointer.ptr[0].number_of_elements):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_cur_scope-&gt;__pyx_v_pointer-&gt;ptr[0]).number_of_elements;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_cur_scope-&gt;__pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:                 yield &lt;object&gt;pointer.ptr[0].bucket[i].item</pre>
<pre class='cython code score-3 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((__pyx_cur_scope-&gt;__pyx_v_pointer-&gt;ptr[0]).bucket[__pyx_cur_scope-&gt;__pyx_v_i]).item));
    __pyx_r = ((PyObject *)((__pyx_cur_scope-&gt;__pyx_v_pointer-&gt;ptr[0]).bucket[__pyx_cur_scope-&gt;__pyx_v_i]).item);
    __pyx_cur_scope-&gt;__pyx_t_0 = __pyx_t_1;
    __pyx_cur_scope-&gt;__pyx_t_1 = __pyx_t_2;
    __pyx_cur_scope-&gt;__pyx_t_2 = __pyx_t_3;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
    /* return from generator, yielding value */
    __pyx_generator-&gt;resume_label = 1;
    return __pyx_r;
    __pyx_L6_resume_from_yield:;
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_t_0;
    __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_t_1;
    __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_t_2;
    if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">345</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>:             if pointer.ptr[0].subtree:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_cur_scope-&gt;__pyx_v_pointer-&gt;ptr[0]).subtree != 0);
  if (__pyx_t_4) {
/* … */
  }
  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">347</span>:                 for i in range(number_of_children):</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_number_of_children;
    __pyx_t_2 = __pyx_t_1;
    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
      __pyx_cur_scope-&gt;__pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">348</span>:                     child_pointer = TreePointer()</pre>
<pre class='cython code score-3 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(((PyObject *)__pyx_ptype_8orthtree_TreePointer));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGOTREF</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_child_pointer));
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_child_pointer, ((struct __pyx_obj_8orthtree_TreePointer *)__pyx_t_5));
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:                     child_pointer.ptr = &amp;(pointer.ptr[0].subtree[i])</pre>
<pre class='cython code score-0 '>      __pyx_cur_scope-&gt;__pyx_v_child_pointer-&gt;ptr = (&amp;((__pyx_cur_scope-&gt;__pyx_v_pointer-&gt;ptr[0]).subtree[__pyx_cur_scope-&gt;__pyx_v_i]));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>:                     yield from recursive_yielding_generator(child_pointer)</pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_recursive_yielding_generator)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("recursive_yielding_generator"); <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span> }
      __pyx_t_5 = __pyx_pf_8orthtree_8Orthtree_8__iter___recursive_yielding_generator(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_recursive_yielding_generator, __pyx_cur_scope-&gt;__pyx_v_child_pointer);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_r = <span class='pyx_c_api'>__Pyx_Generator_Yield_From</span>(__pyx_generator, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_r);
      if (likely(__pyx_r)) {
        __pyx_cur_scope-&gt;__pyx_t_0 = __pyx_t_1;
        __pyx_cur_scope-&gt;__pyx_t_1 = __pyx_t_2;
        __pyx_cur_scope-&gt;__pyx_t_2 = __pyx_t_3;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
        <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
        <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
        /* return from generator, yielding value */
        __pyx_generator-&gt;resume_label = 2;
        return __pyx_r;
        __pyx_L10_resume_from_yield_from:;
        __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_t_0;
        __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_t_1;
        __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_t_2;
        if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span>
      } else {
        PyObject* exc_type = <span class='pyx_c_api'>__Pyx_PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || (exc_type != PyExc_GeneratorExit &amp;&amp; <span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration)))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span>
        }
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">351</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:         cdef TreePointer root = TreePointer()</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(((PyObject *)__pyx_ptype_8orthtree_TreePointer));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_root = ((struct __pyx_obj_8orthtree_TreePointer *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:         root.ptr = &amp;(self.root)</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_root-&gt;ptr = (&amp;__pyx_cur_scope-&gt;__pyx_v_self-&gt;root);
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:         yield from recursive_yielding_generator(root)</pre>
<pre class='cython code score-14 '>  __pyx_t_1 = __pyx_pf_8orthtree_8Orthtree_8__iter___recursive_yielding_generator(__pyx_cur_scope-&gt;__pyx_v_recursive_yielding_generator, __pyx_cur_scope-&gt;__pyx_v_root);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = <span class='pyx_c_api'>__Pyx_Generator_Yield_From</span>(__pyx_generator, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_r);
  if (likely(__pyx_r)) {
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
    /* return from generator, yielding value */
    __pyx_generator-&gt;resume_label = 1;
    return __pyx_r;
    __pyx_L4_resume_from_yield_from:;
    if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  } else {
    PyObject* exc_type = <span class='pyx_c_api'>__Pyx_PyErr_Occurred</span>();
    if (exc_type) {
      if (likely(exc_type == PyExc_StopIteration || (exc_type != PyExc_GeneratorExit &amp;&amp; <span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration)))) <span class='py_c_api'>PyErr_Clear</span>();
      else <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
    }
  }
  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
</pre><pre class="cython line score-0">&#xA0;<span class="">355</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:     def query(self, position_1, position_2):</pre>
<pre class='cython code score-30 '>/* Python wrapper */
static PyObject *__pyx_pw_8orthtree_8Orthtree_12query(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_8orthtree_8Orthtree_12query(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_position_1 = 0;
  PyObject *__pyx_v_position_2 = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("query (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_position_1,&amp;__pyx_n_s_position_2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_position_1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_position_2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("query", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "query") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_position_1 = values[0];
    __pyx_v_position_2 = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("query", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.query", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_8orthtree_8Orthtree_11query(((struct __pyx_obj_8orthtree_Orthtree *)__pyx_v_self), __pyx_v_position_1, __pyx_v_position_2);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_8orthtree_8Orthtree_11query(struct __pyx_obj_8orthtree_Orthtree *__pyx_v_self, PyObject *__pyx_v_position_1, PyObject *__pyx_v_position_2) {
  PyObject *__pyx_v_list_position_1 = 0;
  PyObject *__pyx_v_list_position_2 = 0;
  double *__pyx_v_pos1;
  double *__pyx_v_pos2;
  PyObject *__pyx_v_query_results = 0;
  int __pyx_v_i;
  int __pyx_v_number_of_children;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("query", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("orthtree.Orthtree.query", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_list_position_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_list_position_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_query_results);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">357</span>:         # Very fast method which returns objects in a list which are inside the bounding box given by position_1</pre>
<pre class="cython line score-0">&#xA0;<span class="">358</span>:         # and position_2</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:         cdef tuple list_position_1 = tuple(position_1)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_position_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_list_position_1 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>:         cdef tuple list_position_2 = tuple(position_2)</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_position_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_list_position_2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">361</span>:         cdef double* pos1</pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>:         cdef double* pos2</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:         cdef list query_results = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_query_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:         cdef int i, number_of_children = 1 &lt;&lt; self.number_of_dims</pre>
<pre class='cython code score-0 '>  __pyx_v_number_of_children = (1 &lt;&lt; __pyx_v_self-&gt;number_of_dims);
</pre><pre class="cython line score-0">&#xA0;<span class="">365</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>:         if len(list_position_1) != len(list_position_2):</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_list_position_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_list_position_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  __pyx_t_4 = ((__pyx_t_2 != __pyx_t_3) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:             raise IndexError('invalid position(s)')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_IndexError, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 367, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_invalid_position_s);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:         if len(list_position_1) != self.number_of_dims:</pre>
<pre class='cython code score-1 '>  __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_list_position_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 368, __pyx_L1_error)</span>
  __pyx_t_4 = ((__pyx_t_3 != __pyx_v_self-&gt;number_of_dims) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:             raise IndexError('invalid position(s)')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_IndexError, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_invalid_position_s);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class="cython line score-0">&#xA0;<span class="">370</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:         pos1 = &lt;double*&gt;PyMem_Malloc(sizeof(double) * self.number_of_dims)</pre>
<pre class='cython code score-5 '>  __pyx_v_pos1 = ((double *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(double)) * __pyx_v_self-&gt;number_of_dims)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:         if not pos1:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((!(__pyx_v_pos1 != 0)) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:             raise MemoryError('could not allocate memory for positions')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__19, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_po);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre><pre class="cython line score-0">&#xA0;<span class="">374</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">375</span>:         pos2 = &lt;double*&gt;PyMem_Malloc(sizeof(double) * self.number_of_dims)</pre>
<pre class='cython code score-5 '>  __pyx_v_pos2 = ((double *)<span class='py_c_api'>PyMem_Malloc</span>(((sizeof(double)) * __pyx_v_self-&gt;number_of_dims)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>:         if not pos2:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((!(__pyx_v_pos2 != 0)) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:             PyMem_Free(pos1)</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">378</span>:             raise MemoryError('could not allocate memory for positions')</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__20, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_could_not_allocate_memory_for_po);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
</pre><pre class="cython line score-0">&#xA0;<span class="">379</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:         try:</pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:             for i in range(self.number_of_dims):</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_self-&gt;number_of_dims;
    __pyx_t_6 = __pyx_t_5;
    for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:                 pos1[i] = float(list_position_1[i])</pre>
<pre class='cython code score-10 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_list_position_1, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 382, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_t_1); if (unlikely(__pyx_t_8 == ((double)((double)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L8_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_pos1[__pyx_v_i]) = __pyx_t_8;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:                 pos2[i] = float(list_position_2[i])</pre>
<pre class='cython code score-10 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_list_position_2, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_t_1); if (unlikely(__pyx_t_8 == ((double)((double)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L8_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_pos2[__pyx_v_i]) = __pyx_t_8;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">384</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:             query(query_results, self.number_of_dims, number_of_children, &amp;(self.root), pos1, pos2)</pre>
<pre class='cython code score-0 '>    __pyx_f_8orthtree_query(__pyx_v_query_results, __pyx_v_self-&gt;number_of_dims, __pyx_v_number_of_children, (&amp;__pyx_v_self-&gt;root), __pyx_v_pos1, __pyx_v_pos2);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>:             return query_results</pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_query_results);
    __pyx_r = __pyx_v_query_results;
    goto __pyx_L7_return;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">388</span>:         finally:</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">389</span>:             PyMem_Free(pos1)</pre>
<pre class='cython code score-17 '>  /*finally:*/ {
    __pyx_L8_error:;
    /*exception exit:*/{
      __Pyx_PyThreadState_declare
      __Pyx_PyThreadState_assign
      __pyx_t_10 = 0; __pyx_t_11 = 0; __pyx_t_12 = 0; __pyx_t_13 = 0; __pyx_t_14 = 0; __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_13, &amp;__pyx_t_14, &amp;__pyx_t_15);
      if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_10, &amp;__pyx_t_11, &amp;__pyx_t_12) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_11, &amp;__pyx_t_12);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_13);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_14);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_15);
      __pyx_t_5 = __pyx_lineno; __pyx_t_6 = __pyx_clineno; __pyx_t_9 = __pyx_filename;
      {
        <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos1);
/* … */
      <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos1);
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:             PyMem_Free(pos2)</pre>
<pre class='cython code score-14 '>        <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos2);
      }
      if (PY_MAJOR_VERSION &gt;= 3) {
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);
      __pyx_t_10 = 0; __pyx_t_11 = 0; __pyx_t_12 = 0; __pyx_t_13 = 0; __pyx_t_14 = 0; __pyx_t_15 = 0;
      __pyx_lineno = __pyx_t_5; __pyx_clineno = __pyx_t_6; __pyx_filename = __pyx_t_9;
      goto __pyx_L1_error;
    }
    __pyx_L7_return: {
      __pyx_t_15 = __pyx_r;
      __pyx_r = 0;
/* … */
      <span class='py_c_api'>PyMem_Free</span>(__pyx_v_pos2);
      __pyx_r = __pyx_t_15;
      __pyx_t_15 = 0;
      goto __pyx_L0;
    }
  }
</pre></div></body></html>
